---
links:
  - https://youtu.be/vQldMjSJ6-w?si=674wM6gN4v-4TWiz
  - https://youtu.be/601CnGGp_MU?si=7ivsSHHI6pKJFb-x
  - https://youtu.be/_BSag4ABBMY?si=H9PYooSnrOuiQ4BV
---

## Раньше
![[Screenshot 2024-03-10 at 13.20.43.png]]
 Потом появились микросервисы, внешние авторизации
 ![[Screenshot 2024-03-10 at 13.24.15.png]]
![[Screenshot 2024-03-10 at 13.28.49.png]]

## Проблемы
![[Screenshot 2024-03-10 at 13.35.19.png]]

## JWT (JSON Web Token)
— это специальный формат токена, который позволяет безопасно передавать данные между клиентом и сервером.

JWT-токен состоит из трех частей, которые разделены точкой:

- **Header** или **заголовок** — информация о токене, тип токена и алгоритм шифрования
- **Payload** или **полезные данные** — данные, которые мы хотим передать в токене. Например, имя пользователя, его роль, истекает ли токен. Эти данные представлены в виде JSON-объекта
- **Signature** или **подпись** — подпись токена, которая позволяет проверить, что токен не был изменен

все части кэшируется с помощью `Base64Url-кодирования`
### **Header**

Заголовок обычно состоит из JSON-объекта с двумя свойствами:

- Тип токена, который в нашем случае — _JWT_
- Алгоритм шифрования, который в нашем случае — _HMAC SHA256_

### **Payload**

Вторая часть токена — это полезная нагрузка в виде JSON-объекта. Она содержит различные данные об авторизованном пользователе. Значение этой части JWT-токена различно в каждом веб-приложении. Мы можем записать здесь любые публичные данные, которые могут быть полезны при авторизации.

```json
{
	"sub": "1234567890",
	"name": "John Doe",
	"iat": 1516239022
}
```

### **Signature**

Чтобы создать подпись, мы должны взять закодированный заголовок, закодированную полезную нагрузку, секретную строку и зашифровать эти данные. При этом нужно использовать алгоритм шифрования из заголовка JWT-токена.

Передается в хедере `Authorization: bearer <jwt>`